E-commerce Secure – Angular / Node.js / MySQL

Projet de site e-commerce avec backend sécurisé en Node.js / Express et frontend en Angular standalone, utilisant MySQL comme base de données.

L’objectif principal du projet est la sécurité :

Authentification sécurisée (bcrypt + JWT en cookie HttpOnly)

Gestion des rôles (USER / ADMIN)

Contrôle d’accès (RBAC)

Protection contre les attaques courantes (brute force, XSS, injections SQL)

Gestion des secrets via .env (aucun mot de passe dans le code)

Architecture du projet
ecommerce-secure/
├── backend/         # API sécurisée Node.js / Express / MySQL
└── frontend/        # Application Angular (standalone)

Stack technique
Backend

Node.js / Express

MySQL + mysql2 (promise pool)

bcrypt

JWT (jsonwebtoken)

Helmet

express-rate-limit

cors

cookie-parser

dotenv

Frontend

Angular (standalone components)

HttpClient

FormsModule

Interceptor pour les cookies

Guards (AuthGuard, AdminGuard)

Prérequis

Node.js (version 18+ conseillée)

npm

Angular CLI

npm install -g @angular/cli


MySQL (WAMP, XAMPP, MAMP ou serveur MySQL natif)

Outil de test HTTP (Thunder Client ou Postman)

Installation – Backend

Ouvrir un terminal :

cd backend
npm install

1. Configuration .env

Créer le fichier .env :

DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=
DB_NAME=ecommerce_secure

JWT_SECRET=une_chaine_ultra_secrete_a_changer

NODE_ENV=development

ADMIN_NAME=Manel
ADMIN_EMAIL=manel.benhamouda@efrei.net
ADMIN_PASSWORD=ManelBenhamouda1234!


.env est ignoré par Git.

2. Création de la base de données MySQL

Créer la base :

CREATE DATABASE ecommerce_secure CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE ecommerce_secure;


Table users :

CREATE TABLE users (
  id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(100) NOT NULL,
  email VARCHAR(255) NOT NULL UNIQUE,
  password VARCHAR(255) NOT NULL,
  role ENUM('USER', 'ADMIN') NOT NULL DEFAULT 'USER',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);


Table products :

CREATE TABLE products (
  id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(150) NOT NULL,
  description TEXT,
  price DECIMAL(10,2) NOT NULL,
  stock INT UNSIGNED NOT NULL DEFAULT 0,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);


Table comments :

CREATE TABLE comments (
  id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
  product_id INT UNSIGNED NOT NULL,
  user_id INT UNSIGNED NOT NULL,
  content TEXT NOT NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT fk_comments_product
    FOREIGN KEY (product_id) REFERENCES products(id)
    ON DELETE CASCADE,
  CONSTRAINT fk_comments_user
    FOREIGN KEY (user_id) REFERENCES users(id)
    ON DELETE CASCADE
);

3. Tester la connexion MySQL
node src/config/test-db.js

4. Création de l’admin initial
node src/scripts/createAdmin.js


L’admin créé :

Nom : Manel

Email : manel.benhamouda@efrei.net

Role : ADMIN

Mot de passe : hash bcrypt

5. Lancer le backend
npm start


Accessible sur :

http://localhost:3000

Installation – Frontend

Dans un deuxième terminal :

cd frontend
npm install
ng serve


Accessible sur :

http://localhost:4200

Le backend et le frontend doivent tourner simultanément.

Communication Front / Back

Frontend : http://localhost:4200

Backend : http://localhost:3000

CORS est configuré pour permettre les cookies (withCredentials: true).

Sécurité (détails)
Authentification

Vérification email

Mot de passe fort (12+ caractères, 3 types de caractères)

Hashage bcrypt

Connexion avec création de JWT signé

Cookies sécurisés

Le JWT est stocké dans un cookie HttpOnly :

httpOnly: true
secure: isProd
sameSite: isProd ? "strict" : "lax"
maxAge: 1800000


En développement : pas de HTTPS, donc secure = false.

En production : HTTPS requis, secure = true.

Contrôle d’accès (RBAC)

Middlewares :

authMiddleware : vérifie le cookie et décode JWT

adminOnly : autorise uniquement ADMIN

Anti brute-force

express-rate-limit limite les tentatives de connexion.

Sécurité HTTP

helmet() ajoute des headers importants :

X-Content-Type-Options

X-Frame-Options

Referrer-Policy

Sécurité SQL

Toutes les requêtes utilisent des requêtes préparées :

db.query("SELECT * FROM users WHERE email = ?", [email]);

Sécurité XSS

Les commentaires sont échappés :

< devient &lt;  
> devient &gt;

API Backend – Documentation rapide
Auth
POST /api/auth/register

Créer un utilisateur.

POST /api/auth/login

Renvoie un cookie HttpOnly.

POST /api/auth/logout

Supprime le cookie.

User
GET /api/profile

Retourne les infos de l’utilisateur connecté.
Protégé par authentification.

Admin
GET /api/admin/dashboard

Admin uniquement.

POST /api/admin/products

Créer un produit.

PUT /api/admin/products/:id

Modifier un produit.

DELETE /api/admin/products/:id

Supprimer un produit.

Produits publics
GET /api/products

Liste de produits.

GET /api/products/:id

Détails d’un produit.

Commentaires
GET /api/products/:id/comments

Commentaires du produit.

POST /api/products/:id/comments

Nécessite d’être connecté.

Tests recommandés
Auth

Connexion valide → cookie présent

Connexion invalide → erreur

Profil sans cookie → 401 Unauthorized

Profil avec cookie → données correctes

Rôles

USER → accès admin refusé (403)

ADMIN → accès autorisé

XSS

Envoyer <script>alert()</script>

Vérifier que le serveur renvoie &lt;script&gt;

Rate limit

Plusieurs tentatives de login rapides

Le serveur doit bloquer après 10 tentatives

Lancement rapide
cd backend
npm install
npm start

cd frontend
npm install
ng serve


Backend : http://localhost:3000

Frontend : http://localhost:4200

Conclusion

Ce projet met en place :

Une API sécurisée avec Node.js / Express

Un système complet d’authentification sécurisé

Un modèle RBAC avec rôles USER / ADMIN

Sécurisation contre XSS, injections SQL, brute-force

Architecture Angular moderne avec standalone components

Sécurité renforcée via cookies HttpOnly et Helmet

Gestion des secrets via .env

CRUD produits et commentaires protégés

L’ensemble respecte les bonnes pratiques OWASP et une structure professionnelle.

-----------------------------------------------------------------------
FIN DU README.md
-----------------------------------------------------------------------